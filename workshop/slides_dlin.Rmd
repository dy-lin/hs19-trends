---
title: "Hackseq: Trends in Bioinformatics"
author: "Diana Lin and Emma Garlock"
date: "14/11/2019"
output: ioslides_presentation
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=12, fig.height=8)
# knitr::opts_chunk$set(echo = TRUE, error = FALSE, message = FALSE, warning = FALSE, fig.width=12, fig.height=8)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
# library(plotly)
# library(cowplot)
library(tidyverse)
library(gganimate)
# library(fulltext)
library(knitr)
```

```{r load sequencing data, include=FALSE, echo = FALSE}
# Load data for all 7 sequencing types
url <- "https://raw.githubusercontent.com/dy-lin/hs19-trends/master/data/sequencing-specific.csv"
seq_spec <- read_csv(url)
```
## Trends in Bioinformatics
* Bioinformatics: <insert definition>
* Analyze trends by webscraping/textmining
  * using `fulltext` , `pubchunks`
* Divide the field of Bioinformatics into topics
  * Sequencing, Assembly, ...
* Determine search terms for each subjects.
  * Sequencing: Sanger, next-generation sequencing, ...

### Analogy
* __Field:__ Fruits
* __Topics:__ Apples (Oranges, ...)
* __Search Term:__ Ambrosia, Gala, McIntosh, Granny Smith, ...

## Webscraping Results

Read in the file:

```{r overview, echo = FALSE}
resFound <- read_csv("")

resFound %>%
  group_by(topic, db) %>%
  summarize(sum = sum(found)) %>%
  ggplot(aes(x = topic, y = sum)) +
  geom_col(aes(fill = db)) + 
  theme(axis.text.x = element_text(angle = 30),
        text = element_text(size = 20),
        axis.title = element_text(size =18),
        axis.text = element_text(size=12)
        ) +
  scale_y_continuous(label = scales::comma_format()) +
  labs(title = "", y = "# Papers Found", x = "Topic", fill = "Database")
```


<!-- ```{r, out.width = "830px", echo = FALSE}
knitr::include_graphics("https://dy-lin.github.io/hs19-trends/figures/overview.png")
```-->


## Original Dataset {.smaller}
```{r}
head(seq_spec)
```

## GGANIMATE CODE:
```{r ordering racing bars, include = FALSE}
ordered_df <- NULL

for (yr in 2003:2019) {
  order <- seq_data %>% 
    filter(Year == yr) %>% 
    arrange(cum_total) %>% 
    mutate(ordering = row_number())
  
  ordered_df <- ordered_df %>% rbind(order)
}
```

```{r racing bars animate, echo=FALSE}
p <- ordered_df %>% 
  ggplot(aes(ordering, group = topic))+
  geom_tile(aes(y = cum_total/2,
                height = cum_total,
                width = 0.9,
                fill = topic)) +
  geom_text(aes(y = cum_total, label = topic), hjust = "left", fontface = "bold", nudge_y = 50) +
  scale_fill_viridis_d() +
  coord_cartesian(clip = "off", expand = FALSE) +
  coord_flip() +
#animate
  transition_states(Year, transition_length = 8, state_length = 4, wrap = FALSE) +
  ease_aes("cubic-in-out") +
#aesthetics
  labs(subtitle = "Trends in sequencing methods",title = "Year {closest_state}", y = "cumulative total papers") +
  theme(plot.background = element_blank(),
        legend.position = "none",
        axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        text = element_text(size=14),
        plot.title = element_text(size = 35)) +
  ylim(0,1300) +
  xlab("") 

#rendering the animation
animate(p, nframes = 750, 
        fps = 20, 
        end_pause = 10)
```

